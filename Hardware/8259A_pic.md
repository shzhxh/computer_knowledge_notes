#### 8259A概述

![8259A引脚](_img/8259A_pin.jpg "8259A引脚")

8259A芯片是一个中断管理芯片，中断的来源除了来自于硬件自身的NMI中断和来自于软件的`INT n`指令造成的软件中断之外，还有来自于外部硬件设备的中断，这些中断是可屏蔽的。这些中断也都通过**PIC**(Programmable Interrupt Controller)进行控制，并传递给CPU。

一个8259A芯片的可以接最多8个中断源，但由于可以将2个或多个8259A芯片级连（cascade），并且最多可以级连到9个，所以最多可以接64个中断源。如今绝大多数的PC都拥有两个8259A，这样 最多可以接收15个中断源。

8259提供了两种屏蔽方式：1,简单方式，提供8位屏蔽字对应各个IR。2,特殊方式，允许CPU让低优先级的外设去中断高优先级的服务程序。

#### 内部结构

![8259A内部结构](_img/8259A_structure.jpg)

- IRR:中断请求寄存器8位，IR0～IR7每一位对应一个设备，共可接收8个设备的中断请求。
- IMR:中断屏蔽寄存器为8位，设置需要屏蔽的中断请求
- ISR：中断服务寄存器为8位，保存当前正在处理的中断请求
- PR：优先权判别器。当多个中断同时发生时，将高优先级者优先传递给CPU。优先级选择方式有4种：1,完全嵌套方式，优先级从IR0到IR7依次降低。2,轮换方式A，一个中断完成后立即把它放到最低优先级的位置上。3,轮换方式B，CPU可以在任何时间规定最优优先级。4,查询方式，CPU访问中断状态寄存器。
- 控制逻辑：向CPU发出中断请求信号INT，并接受CPU的中断响应信号INTA。
- 数据总线缓冲器：保存数据总线的数据，传输命令控制字、状态字和中断类型码。
- 读/写逻辑：确定数据总线缓冲器中数据的传输方向，选择内部的各命令字寄存器。RD为读，WR为写，AO为I/O端口识别，CS为设备选择。
- 级联缓冲/比较器：主从控制器的级联是由级联总线CAS0，CAS1，CAS2实现的。

#### 工作原理

![8259A级联](_img/8259A_link.jpg)

#### 实例：两个中断控制器连接

![8259A级联](_img/8259A_link2.gif)

​     	Master 8259A:   
		0x20: ICW1,OCW2,OCW3,IRR,ISR  
		0x21: ICW2,ICW3,ICW4,IMR, address registers  
	Slave 8259A:   
		0xA0: ICW1,OCW2,OCW3,IRR,ISR  
		0xA1: ICW2,ICW3,ICW4,IMR, address registers